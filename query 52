SELECT C.CNAME, C.RATING 
FROM CUST C 
JOIN ORDERS O ON C.CNUM = O.CNUM 
GROUP BY C.CNUM, C.CNAME, C.RATING 
HAVING AVG(O.AMT) > (SELECT AVG(AMT) FROM ORDERS);